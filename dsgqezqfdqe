1ï¸âƒ£ Gestion des utilisateurs Windows
ğŸ“ Ã‰tape 1 : CrÃ©ation des utilisateurs et des groupes
Dans PowerShell, exÃ©cute ces commandes :

CrÃ©er les groupes (grp1, grp2, grp3) :

powershell
Copier
Modifier
New-LocalGroup -Name "grp1"
New-LocalGroup -Name "grp2"
New-LocalGroup -Name "grp3"
CrÃ©er les utilisateurs (user1, user2, user3) :

powershell
Copier
Modifier
New-LocalUser -Name "user1" -Password (ConvertTo-SecureString "P@ssword1" -AsPlainText -Force) -FullName "Tux1" -Description "Utilisateur 1"
New-LocalUser -Name "user2" -Password (ConvertTo-SecureString "P@ssword2" -AsPlainText -Force)
New-LocalUser -Name "user3" -Password (ConvertTo-SecureString "P@ssword3" -AsPlainText -Force) -UserMayChangePassword $false -AccountNeverExpires $true
# CrÃ©ation de user3
New-LocalUser -Name "user3" -Password (ConvertTo-SecureString "P@ssword3" -AsPlainText -Force)

# DÃ©sactiver la possibilitÃ© de changer le mot de passe et activer "ne jamais expirer"
net user user3 /Passwordchg:no /Expires:never
Attribuer les groupes aux utilisateurs :

powershell
Copier
Modifier
Add-LocalGroupMember -Group "grp1" -Member "user1"
Add-LocalGroupMember -Group "grp2" -Member "user2"
Add-LocalGroupMember -Group "grp3" -Member "user3"
Add-LocalGroupMember -Group "grp3" -Member "user2"
Add-LocalGroupMember -Group "grp1" -Member "user2"
CrÃ©er un utilisateur avec ton prÃ©nom dans le groupe Administrateurs :

powershell
Copier
Modifier
New-LocalUser -Name "MonPrenom" -Password (ConvertTo-SecureString "AdminPass" -AsPlainText -Force)
Add-LocalGroupMember -Group "Administrators" -Member "MonPrenom"
ğŸ“ Ã‰tape 2 : Modifier un mot de passe en ligne de commande
Change le mot de passe de user1 :

powershell
Copier
Modifier
Set-LocalUser -Name "user1" -Password (ConvertTo-SecureString "NewP@ssword1" -AsPlainText -Force)
ğŸ“ Ã‰tape 3 : Lister les utilisateurs et groupes
Lister les utilisateurs locaux :

powershell
Copier
Modifier
Get-LocalUser
Lister les groupes locaux :

powershell
Copier
Modifier
Get-LocalGroup
Lister les membres dâ€™un groupe spÃ©cifique (grp1) :

powershell
Copier
Modifier
Get-LocalGroupMember -Group "grp1"
Exporter ces infos dans un fichier ex2.txt :

powershell
Copier
Modifier
Get-LocalUser > C:\Users\Public\ex2.txt
Get-LocalGroup >> C:\Users\Public\ex2.txt
2ï¸âƒ£ Gestion des permissions Windows
ğŸ“ Ã‰tape 1 : CrÃ©er un dossier et des fichiers
Connecte-toi avec lâ€™utilisateur MonPrenom (crÃ©Ã© plus tÃ´t) et exÃ©cute :

powershell
Copier
Modifier
New-Item -Path "C:\Users\Labo9" -ItemType Directory
New-Item -Path "C:\Users\Labo9\file1.txt" -ItemType File
New-Item -Path "C:\Users\Labo9\file2.txt" -ItemType File
ğŸ“ Ã‰tape 2 : Modifier les permissions
Fichier 1 : Mettre en lecture seule pour grp1 (via GUI)

Clic droit sur file1.txt > PropriÃ©tÃ©s > SÃ©curitÃ© > Modifier

Ajouter grp1, cocher Lecture seule, Appliquer.

Fichier 2 : Lire/Ã©crire/exÃ©cuter pour user2 (via PowerShell)

powershell
Copier
Modifier
$acl = Get-Acl "C:\Users\Labo9\file2.txt"
$rule = New-Object System.Security.AccessControl.FileSystemAccessRule("user2", "FullControl", "Allow")
$acl.SetAccessRule($rule)
Set-Acl "C:\Users\Labo9\file2.txt" $acl
ğŸ“ Ã‰tape 3 : VÃ©rifier les permissions
Teste avec les utilisateurs user1 et user2 :

user1 : essaie de modifier file1.txt â†’ Ã§a devrait Ã©chouer.

user2 : essaie de modifier file2.txt â†’ Ã§a devrait rÃ©ussir.

ğŸ“ Ã‰tape 4 : Script de vÃ©rification des droits
CrÃ©e un fichier siontedisquelelaifait.ps1 contenant :

powershell
Copier
Modifier
Get-ChildItem -Path "C:\Users\Labo9" -Recurse | ForEach-Object {
    $acl = Get-Acl $_.FullName
    Write-Output "Fichier : $($_.Name)"
    Write-Output "PropriÃ©taire : $($acl.Owner)"
    Write-Output "Groupe : $($acl.Group)"
    Write-Output "Droits d'accÃ¨s :"
    foreach ($rule in $acl.Access) {
        Write-Output " - $rule"
    }
    Write-Output ""
}
Puis exÃ©cute-le :

powershell
Copier
Modifier
.\siontedisquelelaifait.ps1 > C:\Users\Public\ex3.txt
3ï¸âƒ£ StratÃ©gie dâ€™audit Windows
ğŸ“ Ã‰tape 1 : Activer lâ€™audit des connexions
Ouvre la StratÃ©gie de SÃ©curitÃ© Locale (secpol.msc)

Va dans : StratÃ©gies locales > StratÃ©gie dâ€™audit

Active lâ€™audit des Ã©vÃ©nements suivants :

"Ouverture/fermeture de session" â†’ Cocher SuccÃ¨s et Ã‰chec.

"CrÃ©ation et fin d'un processus" â†’ Cocher SuccÃ¨s et Ã‰chec.

Appliquer et fermer.

ğŸ“ Ã‰tape 2 : Tester lâ€™audit des connexions
Ouvre lâ€™Observateur dâ€™Ã©vÃ©nements (eventvwr.msc)

Va dans : Journaux Windows > SÃ©curitÃ©

CrÃ©er un filtre :

CatÃ©gorie : Connexion et DÃ©connexion.

Supprime les Ã©vÃ©nements du journal pour voir les nouveaux logs plus facilement.

Test :

Essaie de te connecter avec un utilisateur.

Fais exprÃ¨s de rater le mot de passe plusieurs fois.

VÃ©rifie si des logs sont gÃ©nÃ©rÃ©s.

ğŸ“ Ã‰tape 3 : Auditer la crÃ©ation de processus
Ouvre lâ€™Observateur dâ€™Ã©vÃ©nements (eventvwr.msc)

Va dans : Journaux Windows > SÃ©curitÃ©

CrÃ©er un filtre :

CatÃ©gorie : CrÃ©ation et fin de processus.

Test :

Ouvre et ferme Notepad (Bloc-notes).

VÃ©rifie si des logs apparaissent.

ğŸ“ Ã‰tape 4 : Exporter les logs
ExÃ©cute :

powershell
Copier
Modifier
Get-EventLog -LogName Security | Where-Object { $_.EventID -eq 4624 -or $_.EventID -eq 4625 } | 
Select-Object TimeGenerated, EventID, Message | Export-Csv -Path C:\Users\Public\ex4.csv -NoTypeInformation
ğŸ“Œ RÃ©sumÃ© des fichiers gÃ©nÃ©rÃ©s
ğŸ“‚ ex2.txt â†’ Liste des utilisateurs et groupes.
ğŸ“‚ ex3.txt â†’ Liste des permissions.
ğŸ“‚ ex4.csv â†’ Journal des connexions.
